{% extends "base.html.twig" %}

{% set title = 'coaster_ranking.title'|trans %}
{% block title %}{{ title }}{% endblock %}


{% block body %}
    <ul class="media-list content-group">
        {% for coaster in coasters %}
            {% set image = images[coaster.id] %}
            <li class="media panel panel-body stack-media-on-mobile">
                <div class="media-left">
                    <a href="{{ path('bdd_show_coaster', {'slug': coaster.slug}) }}">
                        {% if image|length > 0 %}
                            <img src="{{ asset(random(image)) | imagine_filter('thumb_coaster') }}"
                                 class="img-rounded"
                                 style="width:96px;"
                                 alt="{{ coaster.name }}">
                        {% endif %}
                    </a>
                </div>

                <div class="media-body">
                    <h2 class="media-heading">
                        {% if previousAverageRating is not defined or previousAverageRating != coaster.averageRating %}
                            {{ coasters.getPaginationData.firstItemNumber + loop.index - 1 }}
                        {% endif %}
                        -
                        <a style="color:#333;"
                           href="{{ path('bdd_show_coaster', {'slug': coaster.slug}) }}">{{ coaster.name }}
                        </a>
                    </h2>
                    <ul class="list-inline list-inline-separate text-muted mb-10">
                        <li>{{ coaster.builtCoaster.manufacturer.name }}</li>
                        <li>{{ coaster.builtCoaster.types|join(', ') }}</li>
                        <li>{{ coaster.park.name }}, {{ coaster.park.country.name|trans([], 'database') }}</li>
                    </ul>
                </div>
                <div class="media-right text-center">
                    <h3 class="no-margin text-semibold text-nowrap">{{ coaster.averageRating|number_format(2, ',') }} /
                        5</h3>
                    <div class="text-muted">
                        {{ 'coaster_ranking.reviews_number'|transchoice(coaster.totalRatings) }}
                    </div>
                </div>
            </li>
            {% set previousAverageRating = coaster.averageRating %}
        {% endfor %}
    </ul>
    {{ knp_pagination_render(coasters) }}
{% endblock %}